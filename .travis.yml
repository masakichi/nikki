language: go
dist: xenial

sudo: false

env:
  - HUGO_VERSION=0.59.1

install: true

before_script:
  - wget https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_Linux-64bit.deb
  - sudo dpkg -i hugo_${HUGO_VERSION}_Linux-64bit.deb

git:
  depth: false

script:
  # if not set quotepath false, hugo GitInfo feature will fail.
  - git config core.quotepath false
  - hugo --minify

deploy:
  provider: pages
  local-dir: public
  target-branch: gh-pages
  committer-from-gh: true
  skip-cleanup: true
  github-token: $GITHUB_TOKEN
  keep-history: true
  fqdn: gimo.me
  verbose: true
  on:
    branch: master
